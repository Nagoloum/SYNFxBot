[
    {
        "label": "streamlit",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "streamlit",
        "description": "streamlit",
        "detail": "streamlit",
        "documentation": {}
    },
    {
        "label": "st_autorefresh",
        "importPath": "streamlit_autorefresh",
        "description": "streamlit_autorefresh",
        "isExtraImport": true,
        "detail": "streamlit_autorefresh",
        "documentation": {}
    },
    {
        "label": "pandas",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pandas",
        "description": "pandas",
        "detail": "pandas",
        "documentation": {}
    },
    {
        "label": "plotly.express",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "plotly.express",
        "description": "plotly.express",
        "detail": "plotly.express",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timezone",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timezone",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "load_dotenv",
        "importPath": "dotenv",
        "description": "dotenv",
        "isExtraImport": true,
        "detail": "dotenv",
        "documentation": {}
    },
    {
        "label": "load_dotenv",
        "importPath": "dotenv",
        "description": "dotenv",
        "isExtraImport": true,
        "detail": "dotenv",
        "documentation": {}
    },
    {
        "label": "MongoClient",
        "importPath": "pymongo",
        "description": "pymongo",
        "isExtraImport": true,
        "detail": "pymongo",
        "documentation": {}
    },
    {
        "label": "MongoClient",
        "importPath": "pymongo",
        "description": "pymongo",
        "isExtraImport": true,
        "detail": "pymongo",
        "documentation": {}
    },
    {
        "label": "MetaTrader5",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "MetaTrader5",
        "description": "MetaTrader5",
        "detail": "MetaTrader5",
        "documentation": {}
    },
    {
        "label": "logging",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "logging",
        "description": "logging",
        "detail": "logging",
        "documentation": {}
    },
    {
        "label": "SYMBOL",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ATR_PERIOD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RISK_PERCENT",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RR_RATIO",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRAILING_MULTIPLIER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "BREAKEVEN_MULTIPLIER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PARTIAL_CLOSE_PERCENT",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MIN_RR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MIN_CONFIRMATIONS",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RANGE_THRESHOLD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "FVG_THRESHOLD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "VOLATILITY_MIN",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ACCOUNT_NUMBER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PASSWORD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SERVER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MT5_TERMINAL_PATH",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MONGODB_URI",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DB_NAME",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "COLLECTION_NAME",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SYMBOLS",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ATR_PERIOD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "BREAKEVEN_MULTIPLIER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PARTIAL_CLOSE_PERCENT",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DAILY_LOSS_LIMIT",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SYMBOLS",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TIMEFRAME_H4",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TIMEFRAME_H1",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ATR_PERIOD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "EMA_PERIOD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ATR_WINDOW_AVG",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MIN_RR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SL_MULTIPLIER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TP_MULTIPLIER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RSI_PERIOD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RSI_OVERBOUGHT",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RSI_OVERSOLD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PRESETS",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DEVIATION",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MAGIC_NUMBER",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SYMBOLS",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MAX_POSITIONS_PER_SYMBOL",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TELEGRAM_TOKEN",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TELEGRAM_CHAT_ID",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "calculate_atr",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "is_reversal_signal",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "find_swings",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "detect_accumulation",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "find_pivot_candle",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "get_confirmations",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "generate_signal",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "calculate_atr",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "get_preset",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "get_preset",
        "importPath": "strategy",
        "description": "strategy",
        "isExtraImport": true,
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "time",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "time",
        "description": "time",
        "detail": "time",
        "documentation": {}
    },
    {
        "label": "send_telegram_alert",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "send_telegram_alert",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "setup_logging",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "send_telegram_alert",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "send_telegram_alert",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "send_telegram_alert",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "quote_plus",
        "importPath": "urllib.parse",
        "description": "urllib.parse",
        "isExtraImport": true,
        "detail": "urllib.parse",
        "documentation": {}
    },
    {
        "label": "ConnectionFailure",
        "importPath": "pymongo.errors",
        "description": "pymongo.errors",
        "isExtraImport": true,
        "detail": "pymongo.errors",
        "documentation": {}
    },
    {
        "label": "OperationFailure",
        "importPath": "pymongo.errors",
        "description": "pymongo.errors",
        "isExtraImport": true,
        "detail": "pymongo.errors",
        "documentation": {}
    },
    {
        "label": "connect_to_mt5",
        "importPath": "connexion",
        "description": "connexion",
        "isExtraImport": true,
        "detail": "connexion",
        "documentation": {}
    },
    {
        "label": "disconnect",
        "importPath": "connexion",
        "description": "connexion",
        "isExtraImport": true,
        "detail": "connexion",
        "documentation": {}
    },
    {
        "label": "execute_trade",
        "importPath": "trader",
        "description": "trader",
        "isExtraImport": true,
        "detail": "trader",
        "documentation": {}
    },
    {
        "label": "manage_positions",
        "importPath": "position_manager",
        "description": "position_manager",
        "isExtraImport": true,
        "detail": "position_manager",
        "documentation": {}
    },
    {
        "label": "init_db_connection",
        "importPath": "database",
        "description": "database",
        "isExtraImport": true,
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "update_trade_on_close",
        "importPath": "database",
        "description": "database",
        "isExtraImport": true,
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "log_new_trade",
        "importPath": "database",
        "description": "database",
        "isExtraImport": true,
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "asyncio",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "asyncio",
        "description": "asyncio",
        "detail": "asyncio",
        "documentation": {}
    },
    {
        "label": "sys",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sys",
        "description": "sys",
        "detail": "sys",
        "documentation": {}
    },
    {
        "label": "Bot",
        "importPath": "telegram",
        "description": "telegram",
        "isExtraImport": true,
        "detail": "telegram",
        "documentation": {}
    },
    {
        "label": "get_db_collection",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_db_collection():\n    uri = os.getenv(\"MONGODB_URI\")\n    if not uri:\n        st.error(\"MONGODB_URI manquant\")\n        st.stop()\n    client = MongoClient(uri)\n    db = client[os.getenv(\"MONGODB_DB\", \"trading_bot\")]\n    return db[os.getenv(\"MONGODB_COLLECTION\", \"trades\")]\ncollection = get_db_collection()\n@st.cache_data(ttl=30)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "load_trades",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def load_trades():\n    trades = list(collection.find().sort(\"timestamp_open\", -1))\n    if not trades:\n        return pd.DataFrame()\n    df = pd.DataFrame(trades)\n    df[\"timestamp_open\"] = pd.to_datetime(df[\"timestamp_open\"])\n    if \"timestamp_close\" in df.columns:\n        df[\"timestamp_close\"] = pd.to_datetime(df[\"timestamp_close\"])\n    return df\ndf = load_trades()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "collection",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "collection = get_db_collection()\n@st.cache_data(ttl=30)\ndef load_trades():\n    trades = list(collection.find().sort(\"timestamp_open\", -1))\n    if not trades:\n        return pd.DataFrame()\n    df = pd.DataFrame(trades)\n    df[\"timestamp_open\"] = pd.to_datetime(df[\"timestamp_open\"])\n    if \"timestamp_close\" in df.columns:\n        df[\"timestamp_close\"] = pd.to_datetime(df[\"timestamp_close\"])",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "df",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "df = load_trades()\n# Sidebar\nwith st.sidebar:\n    st.title(\"Volatility Bot\")\n    st.caption(\"Bot trend-following sur Volatility Indices\")\n    selected_symbol = st.selectbox(\"March√©\", [\"Tous\"] + sorted(df['symbol'].unique()) if not df.empty else [\"Tous\"])\n    if not df.empty:\n        total_trades = len(df) if selected_symbol == \"Tous\" else len(df[df['symbol'] == selected_symbol])\n        st.metric(\"Total Trades\", total_trades)\n        total_profit = df[\"profit\"].sum() if selected_symbol == \"Tous\" else df[df['symbol'] == selected_symbol][\"profit\"].sum()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "wins",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "wins = len(df[df[\"result\"] == \"win\"])\nwin_rate = wins / len(df) * 100 if len(df) > 0 else 0\ntotal_profit = df[\"profit\"].sum()\navg_profit = df[\"profit\"].mean() if len(df) > 0 else 0\ncol1.metric(\"Trades\", len(df))\ncol2.metric(\"Win Rate\", f\"{win_rate:.1f}%\")\ncol3.metric(\"Profit Net\", f\"{total_profit:+.2f} USD\")\ncol4.metric(\"Profit Moyen\", f\"{avg_profit:+.2f} USD\")\n# Equity curve\nst.header(\"√âvolution Capital\")",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "win_rate",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "win_rate = wins / len(df) * 100 if len(df) > 0 else 0\ntotal_profit = df[\"profit\"].sum()\navg_profit = df[\"profit\"].mean() if len(df) > 0 else 0\ncol1.metric(\"Trades\", len(df))\ncol2.metric(\"Win Rate\", f\"{win_rate:.1f}%\")\ncol3.metric(\"Profit Net\", f\"{total_profit:+.2f} USD\")\ncol4.metric(\"Profit Moyen\", f\"{avg_profit:+.2f} USD\")\n# Equity curve\nst.header(\"√âvolution Capital\")\ndf_sorted = df.sort_values(\"timestamp_open\")",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "total_profit",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "total_profit = df[\"profit\"].sum()\navg_profit = df[\"profit\"].mean() if len(df) > 0 else 0\ncol1.metric(\"Trades\", len(df))\ncol2.metric(\"Win Rate\", f\"{win_rate:.1f}%\")\ncol3.metric(\"Profit Net\", f\"{total_profit:+.2f} USD\")\ncol4.metric(\"Profit Moyen\", f\"{avg_profit:+.2f} USD\")\n# Equity curve\nst.header(\"√âvolution Capital\")\ndf_sorted = df.sort_values(\"timestamp_open\")\ndf_sorted[\"cum_profit\"] = df_sorted[\"profit\"].cumsum()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "avg_profit",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "avg_profit = df[\"profit\"].mean() if len(df) > 0 else 0\ncol1.metric(\"Trades\", len(df))\ncol2.metric(\"Win Rate\", f\"{win_rate:.1f}%\")\ncol3.metric(\"Profit Net\", f\"{total_profit:+.2f} USD\")\ncol4.metric(\"Profit Moyen\", f\"{avg_profit:+.2f} USD\")\n# Equity curve\nst.header(\"√âvolution Capital\")\ndf_sorted = df.sort_values(\"timestamp_open\")\ndf_sorted[\"cum_profit\"] = df_sorted[\"profit\"].cumsum()\nfig = px.line(df_sorted, x=\"timestamp_open\", y=\"cum_profit\", title=\"Profit Cumul√©\")",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "df_sorted",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "df_sorted = df.sort_values(\"timestamp_open\")\ndf_sorted[\"cum_profit\"] = df_sorted[\"profit\"].cumsum()\nfig = px.line(df_sorted, x=\"timestamp_open\", y=\"cum_profit\", title=\"Profit Cumul√©\")\nst.plotly_chart(fig, use_container_width=True)\n# Derniers trades\nst.header(\"Derniers Trades\")\ndisplay_df = df[[\"timestamp_open\", \"symbol\", \"signal\", \"entry_price\", \"sl\", \"tp\", \"volume\", \"result\", \"profit\"]].head(20)\nst.dataframe(display_df, use_container_width=True)\n# Performance semaine\nst.header(\"Perf Semaine\")",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "df_sorted[\"cum_profit\"]",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "df_sorted[\"cum_profit\"] = df_sorted[\"profit\"].cumsum()\nfig = px.line(df_sorted, x=\"timestamp_open\", y=\"cum_profit\", title=\"Profit Cumul√©\")\nst.plotly_chart(fig, use_container_width=True)\n# Derniers trades\nst.header(\"Derniers Trades\")\ndisplay_df = df[[\"timestamp_open\", \"symbol\", \"signal\", \"entry_price\", \"sl\", \"tp\", \"volume\", \"result\", \"profit\"]].head(20)\nst.dataframe(display_df, use_container_width=True)\n# Performance semaine\nst.header(\"Perf Semaine\")\none_week_ago = datetime.now() - timedelta(days=7)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "fig",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "fig = px.line(df_sorted, x=\"timestamp_open\", y=\"cum_profit\", title=\"Profit Cumul√©\")\nst.plotly_chart(fig, use_container_width=True)\n# Derniers trades\nst.header(\"Derniers Trades\")\ndisplay_df = df[[\"timestamp_open\", \"symbol\", \"signal\", \"entry_price\", \"sl\", \"tp\", \"volume\", \"result\", \"profit\"]].head(20)\nst.dataframe(display_df, use_container_width=True)\n# Performance semaine\nst.header(\"Perf Semaine\")\none_week_ago = datetime.now() - timedelta(days=7)\ndf_week = df[df[\"timestamp_open\"] >= one_week_ago]",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "display_df",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "display_df = df[[\"timestamp_open\", \"symbol\", \"signal\", \"entry_price\", \"sl\", \"tp\", \"volume\", \"result\", \"profit\"]].head(20)\nst.dataframe(display_df, use_container_width=True)\n# Performance semaine\nst.header(\"Perf Semaine\")\none_week_ago = datetime.now() - timedelta(days=7)\ndf_week = df[df[\"timestamp_open\"] >= one_week_ago]\nif not df_week.empty:\n    week_profit = df_week[\"profit\"].sum()\n    st.metric(\"Profit Semaine\", f\"{week_profit:+.2f} USD\")\n# Rapport strat√©gie",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "one_week_ago",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "one_week_ago = datetime.now() - timedelta(days=7)\ndf_week = df[df[\"timestamp_open\"] >= one_week_ago]\nif not df_week.empty:\n    week_profit = df_week[\"profit\"].sum()\n    st.metric(\"Profit Semaine\", f\"{week_profit:+.2f} USD\")\n# Rapport strat√©gie\nst.header(\"Rapport Strat√©gie\")\nst.markdown(\"\"\"\n**Strat√©gie :** Trend-following avec filtre volatilit√©.\n- **March√©s :** Volatility 25, 50, 75, 100.",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "df_week",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "df_week = df[df[\"timestamp_open\"] >= one_week_ago]\nif not df_week.empty:\n    week_profit = df_week[\"profit\"].sum()\n    st.metric(\"Profit Semaine\", f\"{week_profit:+.2f} USD\")\n# Rapport strat√©gie\nst.header(\"Rapport Strat√©gie\")\nst.markdown(\"\"\"\n**Strat√©gie :** Trend-following avec filtre volatilit√©.\n- **March√©s :** Volatility 25, 50, 75, 100.\n- **Bias H4 :** EMA50 + pente pour haussier/baissier/neutre.",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_trend_bias",
        "kind": 2,
        "importPath": "backtest",
        "description": "backtest",
        "peekOfCode": "def get_trend_bias(historical_df=None):\n    if historical_df is not None:\n        # Resample les donn√©es H1 en H4 pour le backtest\n        df_h4 = historical_df.resample('4h').agg({\n            'open': 'first',\n            'high': 'max',\n            'low': 'min',\n            'close': 'last',\n            'tick_volume': 'sum'\n        }).dropna()",
        "detail": "backtest",
        "documentation": {}
    },
    {
        "label": "backtest_xaufxbot",
        "kind": 2,
        "importPath": "backtest",
        "description": "backtest",
        "peekOfCode": "def backtest_xaufxbot(start_date: tuple, end_date: tuple, initial_balance: float = 10000.0):\n    \"\"\"Backtest complet de la strat√©gie S/D sur XAUUSD\"\"\"\n    if not mt5.initialize():\n        logging.error(\"√âchec initialisation MT5\")\n        return\n    from_date = datetime(*start_date)\n    to_date = datetime(*end_date)\n    logging.info(\"R√©cup√©ration des donn√©es historiques H1...\")\n    rates = mt5.copy_rates_range(SYMBOL, mt5.TIMEFRAME_H1, from_date, to_date)\n    if rates is None or len(rates) == 0:",
        "detail": "backtest",
        "documentation": {}
    },
    {
        "label": "ACCOUNT_NUMBER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "ACCOUNT_NUMBER = int(os.getenv(\"ACCOUNT_NUMBER\", \"0\"))\nPASSWORD = os.getenv(\"PASSWORD\", \"\")\nSERVER = os.getenv(\"SERVER\", \"\")\n# Symboles g√©r√©s (Volatility Indices - adapte aux noms exacts de ton broker)\nSYMBOLS = [\n    \"Volatility 25 Index\",  # Tranquille\n    \"Volatility 50 Index\",  # Tranquille\n    \"Volatility 75 Index\",  # Agressif\n    \"Volatility 100 Index\"  # Agressif\n]",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PASSWORD",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "PASSWORD = os.getenv(\"PASSWORD\", \"\")\nSERVER = os.getenv(\"SERVER\", \"\")\n# Symboles g√©r√©s (Volatility Indices - adapte aux noms exacts de ton broker)\nSYMBOLS = [\n    \"Volatility 25 Index\",  # Tranquille\n    \"Volatility 50 Index\",  # Tranquille\n    \"Volatility 75 Index\",  # Agressif\n    \"Volatility 100 Index\"  # Agressif\n]\n# Presets par type de symbole",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SERVER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "SERVER = os.getenv(\"SERVER\", \"\")\n# Symboles g√©r√©s (Volatility Indices - adapte aux noms exacts de ton broker)\nSYMBOLS = [\n    \"Volatility 25 Index\",  # Tranquille\n    \"Volatility 50 Index\",  # Tranquille\n    \"Volatility 75 Index\",  # Agressif\n    \"Volatility 100 Index\"  # Agressif\n]\n# Presets par type de symbole\nPRESETS = {",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SYMBOLS",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "SYMBOLS = [\n    \"Volatility 25 Index\",  # Tranquille\n    \"Volatility 50 Index\",  # Tranquille\n    \"Volatility 75 Index\",  # Agressif\n    \"Volatility 100 Index\"  # Agressif\n]\n# Presets par type de symbole\nPRESETS = {\n    \"tranquille\": {  # Pour 25 et 50\n        \"RISK_PERCENT\": 0.005,  # 0.5% risque par trade",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PRESETS",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "PRESETS = {\n    \"tranquille\": {  # Pour 25 et 50\n        \"RISK_PERCENT\": 0.005,  # 0.5% risque par trade\n        \"TRAILING_MULTIPLIER\": 1.5,\n        \"VOLATILITY_LOW\": 0.7,\n        \"VOLATILITY_HIGH\": 1.8\n    },\n    \"agressif\": {  # Pour 75 et 100\n        \"RISK_PERCENT\": 0.01,   # 1% risque par trade\n        \"TRAILING_MULTIPLIER\": 1.2,",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TIMEFRAME_H4",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "TIMEFRAME_H4 = \"H4\"  # Pour bias\nTIMEFRAME_H1 = \"H1\"  # Pour entr√©es\nATR_PERIOD = 14\nEMA_PERIOD = 50  # Pour bias H4\nATR_WINDOW_AVG = 100  # Pour filtre volatilit√©\nMIN_RR = 1.5\nSL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TIMEFRAME_H1",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "TIMEFRAME_H1 = \"H1\"  # Pour entr√©es\nATR_PERIOD = 14\nEMA_PERIOD = 50  # Pour bias H4\nATR_WINDOW_AVG = 100  # Pour filtre volatilit√©\nMIN_RR = 1.5\nSL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ATR_PERIOD",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "ATR_PERIOD = 14\nEMA_PERIOD = 50  # Pour bias H4\nATR_WINDOW_AVG = 100  # Pour filtre volatilit√©\nMIN_RR = 1.5\nSL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "EMA_PERIOD",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "EMA_PERIOD = 50  # Pour bias H4\nATR_WINDOW_AVG = 100  # Pour filtre volatilit√©\nMIN_RR = 1.5\nSL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ATR_WINDOW_AVG",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "ATR_WINDOW_AVG = 100  # Pour filtre volatilit√©\nMIN_RR = 1.5\nSL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MIN_RR",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MIN_RR = 1.5\nSL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SL_MULTIPLIER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "SL_MULTIPLIER = 1.2  # 1-1.5x ATR\nTP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TP_MULTIPLIER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "TP_MULTIPLIER = 2.0  # RR 2\nBREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "BREAKEVEN_MULTIPLIER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "BREAKEVEN_MULTIPLIER = 1.0\nPARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PARTIAL_CLOSE_PERCENT",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "PARTIAL_CLOSE_PERCENT = 0.5\nRSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RSI_PERIOD",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "RSI_PERIOD = 14  # Pour confirmation optionnelle\nRSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RSI_OVERBOUGHT",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "RSI_OVERBOUGHT = 60\nRSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "RSI_OVERSOLD",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "RSI_OVERSOLD = 40\nMAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MAX_POSITIONS_PER_SYMBOL",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MAX_POSITIONS_PER_SYMBOL = 3\nDAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DAILY_LOSS_LIMIT",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "DAILY_LOSS_LIMIT = -0.04  # -4% stop daily\nDEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DEVIATION",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "DEVIATION = 20\nMAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MAGIC_NUMBER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MAGIC_NUMBER = 123456\n# Telegram et MT5\nTELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TELEGRAM_TOKEN",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "TELEGRAM_TOKEN = os.getenv(\"TELEGRAM_TOKEN\", \"\")\nTELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TELEGRAM_CHAT_ID",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "TELEGRAM_CHAT_ID = os.getenv(\"TELEGRAM_CHAT_ID\", \"\")\nMT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MT5_TERMINAL_PATH",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MT5_TERMINAL_PATH = os.getenv(\"MT5_TERMINAL_PATH\", r\"C:\\Program Files\\MetaTrader 5\\terminal64.exe\")\n# MongoDB\nMONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MONGODB_URI",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MONGODB_URI = os.getenv(\"MONGODB_URI\", \"\")\nDB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DB_NAME",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "DB_NAME = os.getenv(\"MONGODB_DB\", \"trading_bot\")\nCOLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "COLLECTION_NAME",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "COLLECTION_NAME = os.getenv(\"MONGODB_COLLECTION\", \"trades\")",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "connect_to_mt5",
        "kind": 2,
        "importPath": "connexion",
        "description": "connexion",
        "peekOfCode": "def connect_to_mt5(max_retries=3, delay=5):\n    \"\"\"Connexion MT5 avec retries\"\"\"\n    terminal_path = MT5_TERMINAL_PATH\n    for attempt in range(1, max_retries + 1):\n        try:\n            if mt5.terminal_info():\n                mt5.shutdown()\n                time.sleep(1)\n            logging.info(f\"Tentative connexion {attempt}/{max_retries}\")\n            if not mt5.initialize(path=terminal_path):",
        "detail": "connexion",
        "documentation": {}
    },
    {
        "label": "disconnect",
        "kind": 2,
        "importPath": "connexion",
        "description": "connexion",
        "peekOfCode": "def disconnect():\n    \"\"\"D√©connexion\"\"\"\n    try:\n        if mt5.terminal_info():\n            mt5.shutdown()\n        logging.info(\"Bot arr√™t√©\")\n        send_telegram_alert(\"üõë Bot arr√™t√©\", force=True)  # Alert close\n    except Exception as e:\n        logging.error(f\"Erreur d√©connexion : {e}\")",
        "detail": "connexion",
        "documentation": {}
    },
    {
        "label": "init_db_connection",
        "kind": 2,
        "importPath": "database",
        "description": "database",
        "peekOfCode": "def init_db_connection():\n    \"\"\"Initialise MongoDB\"\"\"\n    global client, trades_collection\n    if not MONGODB_URI:\n        logging.warning(\"MONGODB_URI manquant ‚Üí DB d√©sactiv√©e\")\n        return False\n    try:\n        # Quote password\n        if \"@\" in MONGODB_URI and \":\" in MONGODB_URI.split(\"@\")[0]:\n            prefix, rest = MONGODB_URI.split(\"://\", 1)",
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "log_new_trade",
        "kind": 2,
        "importPath": "database",
        "description": "database",
        "peekOfCode": "def log_new_trade(symbol, signal, price, sl, tp, volume, ticket=None):\n    \"\"\"Log nouveau trade\"\"\"\n    if trades_collection is None:\n        return None\n    trade_data = {\n        \"timestamp_open\": datetime.utcnow().isoformat(),\n        \"symbol\": symbol,\n        \"signal\": signal,\n        \"entry_price\": float(price) if price else None,\n        \"volume\": float(volume),",
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "update_trade_on_close",
        "kind": 2,
        "importPath": "database",
        "description": "database",
        "peekOfCode": "def update_trade_on_close(ticket, profit, result=\"win\"):\n    \"\"\"Update trade ferm√©\"\"\"\n    if trades_collection is None:\n        return\n    try:\n        update_result = trades_collection.update_one(\n            {\"ticket\": ticket},\n            {\"$set\": {\n                \"timestamp_close\": datetime.utcnow().isoformat(),\n                \"profit\": float(profit),",
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "client",
        "kind": 5,
        "importPath": "database",
        "description": "database",
        "peekOfCode": "client = None\ntrades_collection = None\ndef init_db_connection():\n    \"\"\"Initialise MongoDB\"\"\"\n    global client, trades_collection\n    if not MONGODB_URI:\n        logging.warning(\"MONGODB_URI manquant ‚Üí DB d√©sactiv√©e\")\n        return False\n    try:\n        # Quote password",
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "trades_collection",
        "kind": 5,
        "importPath": "database",
        "description": "database",
        "peekOfCode": "trades_collection = None\ndef init_db_connection():\n    \"\"\"Initialise MongoDB\"\"\"\n    global client, trades_collection\n    if not MONGODB_URI:\n        logging.warning(\"MONGODB_URI manquant ‚Üí DB d√©sactiv√©e\")\n        return False\n    try:\n        # Quote password\n        if \"@\" in MONGODB_URI and \":\" in MONGODB_URI.split(\"@\")[0]:",
        "detail": "database",
        "documentation": {}
    },
    {
        "label": "check_loss_limits",
        "kind": 2,
        "importPath": "position_manager",
        "description": "position_manager",
        "peekOfCode": "def check_loss_limits():\n    today_start = datetime.now(timezone.utc).replace(hour=0, minute=0, second=0, microsecond=0)\n    now = datetime.now(timezone.utc)\n    history = mt5.history_deals_get(today_start, now)\n    if history is None or not history:\n        logging.debug(\"Aucun deal aujourd'hui ou erreur r√©cup√©ration\")\n        return True\n    closed_profit = sum(deal.profit for deal in history if deal.entry == mt5.DEAL_ENTRY_OUT)\n    balance = mt5.account_info().balance\n    if balance <= 0:",
        "detail": "position_manager",
        "documentation": {}
    },
    {
        "label": "manage_positions",
        "kind": 2,
        "importPath": "position_manager",
        "description": "position_manager",
        "peekOfCode": "def manage_positions():\n    \"\"\"G√®re positions pour tous symboles\"\"\"\n    if not check_loss_limits():\n        return\n    for symbol in SYMBOLS:\n        positions = mt5.positions_get(symbol=symbol)\n        if not positions:\n            continue\n        rates_h1 = mt5.copy_rates_from_pos(symbol, mt5.TIMEFRAME_H1, 0, ATR_PERIOD + 10)\n        if not rates_h1:",
        "detail": "position_manager",
        "documentation": {}
    },
    {
        "label": "close_position",
        "kind": 2,
        "importPath": "position_manager",
        "description": "position_manager",
        "peekOfCode": "def close_position(symbol, pos, reason=\"manual\"):\n    \"\"\"Ferme position\"\"\"\n    tick = mt5.symbol_info_tick(symbol)\n    if not tick:\n        return\n    close_price = tick.bid if pos.type == mt5.ORDER_TYPE_BUY else tick.ask\n    request = {\n        \"action\": mt5.TRADE_ACTION_DEAL,\n        \"symbol\": symbol,\n        \"volume\": pos.volume,",
        "detail": "position_manager",
        "documentation": {}
    },
    {
        "label": "get_preset",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def get_preset(symbol):\n    \"\"\"Retourne preset bas√© sur symbole\"\"\"\n    if \"25\" in symbol or \"50\" in symbol:\n        return PRESETS[\"tranquille\"]\n    else:\n        return PRESETS[\"agressif\"]\ndef calculate_atr(df, period):\n    \"\"\"Calcul ATR\"\"\"\n    high_low = df['high'] - df['low']\n    high_close = abs(df['high'] - df['close'].shift())",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "calculate_atr",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def calculate_atr(df, period):\n    \"\"\"Calcul ATR\"\"\"\n    high_low = df['high'] - df['low']\n    high_close = abs(df['high'] - df['close'].shift())\n    low_close = abs(df['low'] - df['close'].shift())\n    tr = pd.concat([high_low, high_close, low_close], axis=1).max(axis=1)\n    return tr.rolling(window=period).mean()\ndef calculate_rsi(df, period):\n    \"\"\"Calcul RSI\"\"\"\n    delta = df['close'].diff()",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "calculate_rsi",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def calculate_rsi(df, period):\n    \"\"\"Calcul RSI\"\"\"\n    delta = df['close'].diff()\n    gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()\n    rs = gain / loss\n    return 100 - (100 / (1 + rs))\ndef get_trend_bias(symbol):\n    \"\"\"Bias H4 : EMA50 + pente\"\"\"\n    rates_h4 = mt5.copy_rates_from_pos(symbol, mt5.TIMEFRAME_H4, 0, EMA_PERIOD + 10)",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "get_trend_bias",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def get_trend_bias(symbol):\n    \"\"\"Bias H4 : EMA50 + pente\"\"\"\n    rates_h4 = mt5.copy_rates_from_pos(symbol, mt5.TIMEFRAME_H4, 0, EMA_PERIOD + 10)\n    if rates_h4 is None or len(rates_h4) < EMA_PERIOD + 1:\n        return \"neutral\"\n    df_h4 = pd.DataFrame(rates_h4)\n    ema = df_h4['close'].ewm(span=EMA_PERIOD, adjust=False).mean()\n    atr_h4 = calculate_atr(df_h4, ATR_PERIOD).iloc[-1]\n    current_price = df_h4['close'].iloc[-1]\n    ema_current = ema.iloc[-1]",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "find_pullback_zone",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def find_pullback_zone(df, bias):\n    \"\"\"Zone S/D simplifi√©e : dernier swing comme support/resistance\"\"\"\n    df['swing_high'] = df['high'][(df['high'].shift(1) < df['high']) & (df['high'].shift(-1) < df['high'])]\n    df['swing_low'] = df['low'][(df['low'].shift(1) > df['low']) & (df['low'].shift(-1) > df['low'])]\n    if bias == \"bullish\":\n        zone_low = df['swing_low'].dropna().iloc[-1] if not df['swing_low'].dropna().empty else None\n        return zone_low, None  # Support pour pullback BUY\n    elif bias == \"bearish\":\n        zone_high = df['swing_high'].dropna().iloc[-1] if not df['swing_high'].dropna().empty else None\n        return None, zone_high  # Resistance pour pullback SELL",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "check_rejection_candle",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def check_rejection_candle(df, bias, zone_low, zone_high):\n    \"\"\"Confirmation : bougie rejet (m√®che + close dans sens bias)\"\"\"\n    last_candle = df.iloc[-1]\n    if bias == \"bullish\" and zone_low:\n        if last_candle['low'] <= zone_low and last_candle['close'] > last_candle['open']:\n            return True\n    elif bias == \"bearish\" and zone_high:\n        if last_candle['high'] >= zone_high and last_candle['close'] < last_candle['open']:\n            return True\n    return False",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "generate_signal",
        "kind": 2,
        "importPath": "strategy",
        "description": "strategy",
        "peekOfCode": "def generate_signal(symbol):\n    \"\"\"G√©n√®re signal pour un symbole\"\"\"\n    preset = get_preset(symbol)\n    volatility_low = preset[\"VOLATILITY_LOW\"]\n    volatility_high = preset[\"VOLATILITY_HIGH\"]\n    bias = get_trend_bias(symbol)\n    if bias == \"neutral\":\n        logging.debug(f\"{symbol} : Bias neutre ‚Üí Skip\")\n        return None\n    rates_h1 = mt5.copy_rates_from_pos(symbol, mt5.TIMEFRAME_H1, 0, ATR_WINDOW_AVG + 50)",
        "detail": "strategy",
        "documentation": {}
    },
    {
        "label": "calculate_lot_size",
        "kind": 2,
        "importPath": "trader",
        "description": "trader",
        "peekOfCode": "def calculate_lot_size(symbol, sl_distance_points, account_balance, risk_percent):\n    \"\"\"Calcul lot bas√© sur risque\"\"\"\n    symbol_info = mt5.symbol_info(symbol)\n    if not symbol_info or symbol_info.point == 0:\n        return 0.01\n    point_value = symbol_info.trade_contract_size * symbol_info.point\n    risk_amount = account_balance * risk_percent\n    lot_size = risk_amount / (sl_distance_points * point_value)\n    return max(round(lot_size, 2), 0.01)\ndef execute_trade(symbol, signal, sl, tp):",
        "detail": "trader",
        "documentation": {}
    },
    {
        "label": "execute_trade",
        "kind": 2,
        "importPath": "trader",
        "description": "trader",
        "peekOfCode": "def execute_trade(symbol, signal, sl, tp):\n    \"\"\"Ex√©cute trade si < max positions\"\"\"\n    positions = mt5.positions_get(symbol=symbol)\n    if positions and len(positions) >= MAX_POSITIONS_PER_SYMBOL:\n        logging.info(f\"{symbol} : Max positions atteint ‚Üí Skip\")\n        return\n    tick = mt5.symbol_info_tick(symbol)\n    if not tick:\n        return\n    price = tick.ask if signal == \"BUY\" else tick.bid",
        "detail": "trader",
        "documentation": {}
    },
    {
        "label": "setup_logging",
        "kind": 2,
        "importPath": "utils",
        "description": "utils",
        "peekOfCode": "def setup_logging():\n    \"\"\"Configure logging : fichier quotidien + console\"\"\"\n    if not os.path.exists(\"logs\"):\n        os.makedirs(\"logs\")\n    log_filename = f\"logs/bot_{datetime.now().strftime('%Y%m%d')}.log\"\n    logging.basicConfig(\n        level=logging.INFO,\n        format=\"%(asctime)s | %(levelname)s | %(message)s\",\n        handlers=[\n            logging.StreamHandler(sys.stdout),",
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "send_telegram_alert",
        "kind": 2,
        "importPath": "utils",
        "description": "utils",
        "peekOfCode": "def send_telegram_alert(message: str, force=False):\n    \"\"\"Envoie alerte Telegram seulement pour √©v√©nements cl√©s (launch, close bot, open/close position)\"\"\"\n    if not TELEGRAM_TOKEN or not TELEGRAM_CHAT_ID:\n        logging.warning(\"Config Telegram manquante\")\n        return\n    try:\n        bot = Bot(token=TELEGRAM_TOKEN)\n        asyncio.run(bot.send_message(chat_id=TELEGRAM_CHAT_ID, text=message.strip(), parse_mode=\"HTML\"))\n    except Exception as e:\n        logging.error(f\"√âchec Telegram : {e}\")",
        "detail": "utils",
        "documentation": {}
    }
]